<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-signin-client_id"
        content="235715095816-g7c1qglfud2isfnbnmukifsuddvn2ubc.apps.googleusercontent.com">
    <title>Enemulado</title>

    <link rel="stylesheet" href="../css/style.css">
    <script type="text/javascript" src="../js/script.js"></script>
    <script src="https://apis.google.com/js/platform.js" async defer></script>

</head>

<body>
    <div class="principal">
        <div class="row-1">
            <div class="col-5" id=logo>
                <button><a href="/"><img src="../img/logo1.png"></a></button>

            </div>

            <div class="col-7">
                <dl id="menu">
                    <dt><a href="/">IN√çCIO</a></dt>
                    <dt><a href="./quemsomos.html">QUEM SOMOS</a></dt>
                    <img id="perfil" src="../img/Ellipse2.png">
                </dl>

            </div>

        </div>

        <div class="row-1 ">
            <div class="col-6 login">
                <h4>Entrar com:</h4>
                <div>
                    <div class="g-signin2" data-onsuccess="onSignIn"></div>
                    <h4 id="ou">ou</h4>
                </div>
                <div class="lo">
                    <input type="text" id="login" placeholder="Login">
                    <input type="password" id="senha" placeholder="Senha">
                    <div class="esqueci">
                        <a id="c" href="./esqueci.html">Esqueci minha senha</a>
                    </div>

                    <a id="senha1" href="../pages/admin1.html"><button>Entrar</button></a>
                </div>

                <div>

                    <a id="senha1"href="./cadastro.html"><button id="criar">Criar conta</button></a>

                   
                </div>



            </div>

            <div class="col-6 login2">
                <img src="../img/imagem_principal4.png">
            </div>

        </div>

        <div class="row-1 azul">
            <div class="col-6">
                <dl>
                    <dt><a href="quemsomos.html">QUEM SOMOS</a></dt>
                    <dt><a href="#CARREIRA">CARREIRA</a></dt>
                    <dt><a href="#ARAINS">A RAINS</a></dt>
                    <dt id="blog"><a href="#BLOG">BLOG</a></dt>
                    <dt><a href="#CONTATO">CONTATO</a></dt>
                </dl>
                <div class="igs">
                    <img src="../img/S.png">
                    <img src="../img/IN.png">
                    <img src="../img/INSTA.png">
                    <img src="../img/TWIT.png">

                </div>





            </div>

            <div class="col-6 EB">
                <button><a href="/"><img id="enemuladinho" src="../img/logo_rodape.png"></a></button>
                <img id="burrozinho" src="../img/burrinho.png">
            </div>
        </div>
    </div>

    <script>
        function signOut() {
            var auth2 = gapi.auth2.getAuthInstance();
            auth2.signOut().then(function () {
                console.log('User signed out.');
            });
        }

        function onSignIn(googleUser) {
            var profile = googleUser.getBasicProfile();

            var xhr = new XMLHttpRequest();

            var id_token = googleUser.getAuthResponse().id_token;

            var teste = profile.getEmail();
            xhr.open('POST', '/login');
            xhr.setRequestHeader('Content-Type', 'application/json');
            xhr.onload = function () {

                if (xhr.responseText == 'success') {

                    fetch('http://localhost:3030/usuarios/' + teste, {
                    })
                        .then(response => response.json())
                        .then(data => {

                            if (data.tamanho > 0) {

                                location.assign('/home')

                            } else {

                                location.assign('/teste/cadastro')
                            }

                        })

                    signOut();

                }
            };
            xhr.send(JSON.stringify({ token: id_token }));
            console.log()
        }
    </script>
</body>

</html>